# Security Headers for Apache Server
# These headers enhance security by preventing various types of attacks

# Prevent MIME type sniffing
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    
    # Content Security Policy - Restrict resource loading
    # default-src 'self': Only allow resources from same origin
    # script-src 'self': Only allow scripts from same origin
    # style-src 'self': Only allow styles from same origin
    # img-src 'self' data:: Allow images from same origin and data URIs (for base64 images)
    # font-src 'self': Only allow fonts from same origin
    # connect-src 'self': Only allow XHR/fetch/WebSocket connections to same origin
    Header set Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; font-src 'self'; connect-src 'self'; base-uri 'self'; form-action 'self';"
    
    # Prevent clickjacking attacks
    Header set X-Frame-Options "SAMEORIGIN"
    
    # Enable XSS protection in browsers
    Header set X-XSS-Protection "1; mode=block"
    
    # Referrer Policy - Control referrer information
    Header set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Permissions Policy - Control browser features
    Header set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=()"
</IfModule>

# Enable GZIP compression for better performance
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Set proper MIME types
<IfModule mod_mime.c>
    AddType text/html .html
    AddType text/css .css
    AddType application/javascript .js
    AddType application/json .json
</IfModule>

# Prevent directory browsing
Options -Indexes

# Follow symbolic links
Options +FollowSymLinks
